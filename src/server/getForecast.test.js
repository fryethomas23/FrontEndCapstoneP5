import getForecast from "./getForecast";

test("gets weather information for a location", async () => {
  let zipCode = "37334";
  let travelDate = "1670216400000";
  global.axios = async (url) => {
    if (/(geonames)/g.test(url)) {
      return {
        postalCodes: [
          {
            adminCode2: "103",
            adminCode1: "TN",
            adminName2: "Lincoln",
            lng: -86.566448,
            countryCode: "US",
            postalCode: "37334",
            adminName1: "Tennessee",
            "ISO3166-2": "TN",
            placeName: "Fayetteville",
            lat: 35.152678,
          },
        ],
      };
    } else if (/(weatherbit)/g.test(url)) {
      return {
        data: [
          {
            moonrise_ts: 1663834151,
            wind_cdir: "SW",
            rh: 61,
            pres: 989.3,
            high_temp: 86,
            sunset_ts: 1663890089,
            ozone: 278.7,
            moon_phase: 0.0414911,
            wind_gust_spd: 14.8,
            snow_depth: 0,
            clouds: 11,
            ts: 1663830060,
            sunrise_ts: 1663846428,
            app_min_temp: 64.7,
            wind_spd: 8.3,
            pop: 0,
            wind_cdir_full: "southwest",
            moon_phase_lunation: 0.9,
            slp: 1014.1,
            app_max_temp: 88.8,
            valid_date: "2022-09-22",
            vis: 11.2,
            snow: 0,
            dewpt: 59.3,
            uv: 5.4,
            weather: {
              icon: "c02d",
              code: 801,
              description: "Few clouds",
            },
            wind_dir: 233,
            max_dhi: null,
            clouds_hi: 0,
            precip: 0,
            low_temp: 53.3,
            max_temp: 86,
            moonset_ts: 1663887422,
            datetime: "2022-09-22",
            temp: 75,
            min_temp: 64.7,
            clouds_mid: 1,
            clouds_low: 11,
          },
          {
            moonrise_ts: 1663924184,
            wind_cdir: "E",
            rh: 33,
            pres: 993.5,
            high_temp: 80.5,
            sunset_ts: 1663976403,
            ozone: 280.2,
            moon_phase: 0.0106615,
            wind_gust_spd: 8.7,
            snow_depth: 0,
            clouds: 9,
            ts: 1663909260,
            sunrise_ts: 1663932873,
            app_min_temp: 53.3,
            wind_spd: 4,
            pop: 0,
            wind_cdir_full: "east",
            moon_phase_lunation: 0.94,
            slp: 1018.6,
            app_max_temp: 78.7,
            valid_date: "2022-09-23",
            vis: 9,
            snow: 0,
            dewpt: 34.7,
            uv: 7.3,
            weather: {
              icon: "c02d",
              code: 801,
              description: "Few clouds",
            },
            wind_dir: 84,
            max_dhi: null,
            clouds_hi: 1,
            precip: 0,
            low_temp: 61.3,
            max_temp: 80.5,
            moonset_ts: 1663975448,
            datetime: "2022-09-23",
            temp: 67.4,
            min_temp: 53.3,
            clouds_mid: 9,
            clouds_low: 0,
          },
          {
            moonrise_ts: 1664014225,
            wind_cdir: "SSE",
            rh: 46,
            pres: 990.5,
            high_temp: 78.7,
            sunset_ts: 1664062717,
            ozone: 277.6,
            moon_phase: 0.000971936,
            wind_gust_spd: 11.9,
            snow_depth: 0,
            clouds: 49,
            ts: 1663995660,
            sunrise_ts: 1664019317,
            app_min_temp: 60.3,
            wind_spd: 5.8,
            pop: 10,
            wind_cdir_full: "south-southeast",
            moon_phase_lunation: 0.97,
            slp: 1017.2,
            app_max_temp: 78.1,
            valid_date: "2022-09-24",
            vis: 11.2,
            snow: 0,
            dewpt: 46.8,
            uv: 6.4,
            weather: {
              icon: "c03d",
              code: 803,
              description: "Broken clouds",
            },
            wind_dir: 151,
            max_dhi: null,
            clouds_hi: 10,
            precip: 0.013,
            low_temp: 61,
            max_temp: 78.7,
            moonset_ts: 1664063416,
            datetime: "2022-09-24",
            temp: 68.8,
            min_temp: 59.7,
            clouds_mid: 37,
            clouds_low: 24,
          },
          {
            moonrise_ts: 1664104281,
            wind_cdir: "SSW",
            rh: 85,
            pres: 981,
            high_temp: 75.1,
            sunset_ts: 1664149031,
            ozone: 283.9,
            moon_phase: 0.0142405,
            wind_gust_spd: 18.6,
            snow_depth: 0,
            clouds: 47,
            ts: 1664082060,
            sunrise_ts: 1664105762,
            app_min_temp: 61.2,
            wind_spd: 7.2,
            pop: 85,
            wind_cdir_full: "south-southwest",
            moon_phase_lunation: 0,
            slp: 1012.1,
            app_max_temp: 75.7,
            valid_date: "2022-09-25",
            vis: 11.4,
            snow: 0,
            dewpt: 62.2,
            uv: 5.5,
            weather: {
              icon: "t03d",
              code: 202,
              description: "Thunderstorm with heavy rain",
            },
            wind_dir: 212,
            max_dhi: null,
            clouds_hi: 14,
            precip: 0.822,
            low_temp: 52.6,
            max_temp: 75.1,
            moonset_ts: 1664151399,
            datetime: "2022-09-25",
            temp: 66.9,
            min_temp: 61,
            clouds_mid: 41,
            clouds_low: 26,
          },
          {
            moonrise_ts: 1664194385,
            wind_cdir: "WSW",
            rh: 61,
            pres: 983.6,
            high_temp: 74.1,
            sunset_ts: 1664235346,
            ozone: 286.1,
            moon_phase: 0.0142405,
            wind_gust_spd: 7.8,
            snow_depth: 0,
            clouds: 0,
            ts: 1664168460,
            sunrise_ts: 1664192207,
            app_min_temp: 53,
            wind_spd: 5.4,
            pop: 0,
            wind_cdir_full: "west-southwest",
            moon_phase_lunation: 0.04,
            slp: 1015,
            app_max_temp: 72.7,
            valid_date: "2022-09-26",
            vis: 15,
            snow: 0,
            dewpt: 47.2,
            uv: 7.1,
            weather: {
              icon: "c01d",
              code: 800,
              description: "Clear Sky",
            },
            wind_dir: 245,
            max_dhi: null,
            clouds_hi: 0,
            precip: 0,
            low_temp: 49.6,
            max_temp: 74.1,
            moonset_ts: 1664237799,
            datetime: "2022-09-26",
            temp: 62.3,
            min_temp: 52.6,
            clouds_mid: 0,
            clouds_low: 0,
          },
          {
            moonrise_ts: 1664284585,
            wind_cdir: "S",
            rh: 53,
            pres: 987.1,
            high_temp: 74.9,
            sunset_ts: 1664321660,
            ozone: 288.6,
            moon_phase: 0.051233,
            wind_gust_spd: 3.8,
            snow_depth: 0,
            clouds: 0,
            ts: 1664254860,
            sunrise_ts: 1664278652,
            app_min_temp: 50.3,
            wind_spd: 3.1,
            pop: 0,
            wind_cdir_full: "south",
            moon_phase_lunation: 0.07,
            slp: 1018.8,
            app_max_temp: 73.4,
            valid_date: "2022-09-27",
            vis: 15,
            snow: 0,
            dewpt: 42.6,
            uv: 7.1,
            weather: {
              icon: "c01d",
              code: 800,
              description: "Clear Sky",
            },
            wind_dir: 176,
            max_dhi: null,
            clouds_hi: 1,
            precip: 0,
            low_temp: 48.6,
            max_temp: 74.9,
            moonset_ts: 1664325879,
            datetime: "2022-09-27",
            temp: 60.4,
            min_temp: 49.6,
            clouds_mid: 0,
            clouds_low: 0,
          },
          {
            moonrise_ts: 1664374924,
            wind_cdir: "ENE",
            rh: 59,
            pres: 990.9,
            high_temp: 68.8,
            sunset_ts: 1664407975,
            ozone: 282.5,
            moon_phase: 0.111418,
            wind_gust_spd: 18.8,
            snow_depth: 0,
            clouds: 3,
            ts: 1664341260,
            sunrise_ts: 1664365097,
            app_min_temp: 49,
            wind_spd: 9.4,
            pop: 0,
            wind_cdir_full: "east-northeast",
            moon_phase_lunation: 0.1,
            slp: 1022.8,
            app_max_temp: 66.9,
            valid_date: "2022-09-28",
            vis: 15,
            snow: 0,
            dewpt: 43,
            uv: 7,
            weather: {
              icon: "c02d",
              code: 801,
              description: "Few clouds",
            },
            wind_dir: 60,
            max_dhi: null,
            clouds_hi: 11,
            precip: 0,
            low_temp: 46.9,
            max_temp: 68.8,
            moonset_ts: 1664414152,
            datetime: "2022-09-28",
            temp: 58,
            min_temp: 48.6,
            clouds_mid: 0,
            clouds_low: 0,
          },
          {
            moonrise_ts: 1664465419,
            wind_cdir: "ENE",
            rh: 62,
            pres: 989.1,
            high_temp: 75.3,
            sunset_ts: 1664494290,
            ozone: 277.6,
            moon_phase: 0.192825,
            wind_gust_spd: 10.3,
            snow_depth: 0,
            clouds: 0,
            ts: 1664427660,
            sunrise_ts: 1664451542,
            app_min_temp: 47,
            wind_spd: 5.8,
            pop: 0,
            wind_cdir_full: "east-northeast",
            moon_phase_lunation: 0.14,
            slp: 1021,
            app_max_temp: 74.2,
            valid_date: "2022-09-29",
            vis: 15,
            snow: 0,
            dewpt: 45.7,
            uv: 7,
            weather: {
              icon: "c01d",
              code: 800,
              description: "Clear Sky",
            },
            wind_dir: 57,
            max_dhi: null,
            clouds_hi: 0,
            precip: 0,
            low_temp: 51.7,
            max_temp: 75.3,
            moonset_ts: 1664502727,
            datetime: "2022-09-29",
            temp: 59.3,
            min_temp: 46.9,
            clouds_mid: 0,
            clouds_low: 0,
          },
          {
            moonrise_ts: 1664556025,
            wind_cdir: "ESE",
            rh: 59,
            pres: 987.1,
            high_temp: 75.7,
            sunset_ts: 1664580606,
            ozone: 273.4,
            moon_phase: 0.29201,
            wind_gust_spd: 7.4,
            snow_depth: 0,
            clouds: 3,
            ts: 1664514060,
            sunrise_ts: 1664537988,
            app_min_temp: 52.2,
            wind_spd: 6,
            pop: 0,
            wind_cdir_full: "east-southeast",
            moon_phase_lunation: 0.17,
            slp: 1018.6,
            app_max_temp: 74.2,
            valid_date: "2022-09-30",
            vis: 15,
            snow: 0,
            dewpt: 47,
            uv: 6.9,
            weather: {
              icon: "c02d",
              code: 801,
              description: "Few clouds",
            },
            wind_dir: 120,
            max_dhi: null,
            clouds_hi: 13,
            precip: 0,
            low_temp: 54.4,
            max_temp: 75.7,
            moonset_ts: 1664591726,
            datetime: "2022-09-30",
            temp: 62.5,
            min_temp: 51.7,
            clouds_mid: 0,
            clouds_low: 0,
          },
          {
            moonrise_ts: 1664646604,
            wind_cdir: "ESE",
            rh: 57,
            pres: 986.4,
            high_temp: 70.8,
            sunset_ts: 1664666922,
            ozone: 270.5,
            moon_phase: 0.404117,
            wind_gust_spd: 17,
            snow_depth: 0,
            clouds: 62,
            ts: 1664600460,
            sunrise_ts: 1664624434,
            app_min_temp: 55,
            wind_spd: 7.2,
            pop: 0,
            wind_cdir_full: "east-southeast",
            moon_phase_lunation: 0.21,
            slp: 1017.9,
            app_max_temp: 69.7,
            valid_date: "2022-10-01",
            vis: 15,
            snow: 0,
            dewpt: 46.7,
            uv: 6.8,
            weather: {
              icon: "c03d",
              code: 803,
              description: "Broken clouds",
            },
            wind_dir: 122,
            max_dhi: null,
            clouds_hi: 99,
            precip: 0,
            low_temp: 59.2,
            max_temp: 70.8,
            moonset_ts: 1664681249,
            datetime: "2022-10-01",
            temp: 62.5,
            min_temp: 54.4,
            clouds_mid: 53,
            clouds_low: 1,
          },
          {
            moonrise_ts: 1664736946,
            wind_cdir: "ESE",
            rh: 80,
            pres: 986,
            high_temp: 69.7,
            sunset_ts: 1664753238,
            ozone: 263.9,
            moon_phase: 0.523,
            wind_gust_spd: 18.8,
            snow_depth: 0,
            clouds: 99,
            ts: 1664686860,
            sunrise_ts: 1664710880,
            app_min_temp: 59.4,
            wind_spd: 9.4,
            pop: 50,
            wind_cdir_full: "east-southeast",
            moon_phase_lunation: 0.24,
            slp: 1017.5,
            app_max_temp: 69.2,
            valid_date: "2022-10-02",
            vis: 14.9,
            snow: 0,
            dewpt: 57.9,
            uv: 6.8,
            weather: {
              icon: "t02d",
              code: 201,
              description: "Thunderstorm with rain",
            },
            wind_dir: 115,
            max_dhi: null,
            clouds_hi: 100,
            precip: 0.123,
            low_temp: 62.6,
            max_temp: 69.7,
            moonset_ts: 1664771312,
            datetime: "2022-10-02",
            temp: 64.1,
            min_temp: 59.2,
            clouds_mid: 99,
            clouds_low: 40,
          },
          {
            moonrise_ts: 1664826853,
            wind_cdir: "SE",
            rh: 91,
            pres: 979.8,
            high_temp: 68,
            sunset_ts: 1664839555,
            ozone: 259,
            moon_phase: 0.641525,
            wind_gust_spd: 46.5,
            snow_depth: 0,
            clouds: 100,
            ts: 1664773260,
            sunrise_ts: 1664797326,
            app_min_temp: 62.7,
            wind_spd: 21.3,
            pop: 90,
            wind_cdir_full: "southeast",
            moon_phase_lunation: 0.27,
            slp: 1011,
            app_max_temp: 64.8,
            valid_date: "2022-10-03",
            vis: 5.7,
            snow: 0,
            dewpt: 61,
            uv: 6.7,
            weather: {
              icon: "r03d",
              code: 502,
              description: "Heavy rain",
            },
            wind_dir: 125,
            max_dhi: null,
            clouds_hi: 100,
            precip: 0.76,
            low_temp: 64.8,
            max_temp: 64.8,
            moonset_ts: 1664775402,
            datetime: "2022-10-03",
            temp: 63.7,
            min_temp: 62.6,
            clouds_mid: 100,
            clouds_low: 53,
          },
          {
            moonrise_ts: 1664916238,
            wind_cdir: "S",
            rh: 96,
            pres: 976,
            high_temp: 67.1,
            sunset_ts: 1664925872,
            ozone: 257,
            moon_phase: 0.752182,
            wind_gust_spd: 23.9,
            snow_depth: 0,
            clouds: 100,
            ts: 1664859660,
            sunrise_ts: 1664883773,
            app_min_temp: 63.9,
            wind_spd: 11.6,
            pop: 90,
            wind_cdir_full: "south",
            moon_phase_lunation: 0.31,
            slp: 1007.3,
            app_max_temp: 68,
            valid_date: "2022-10-04",
            vis: 13.5,
            snow: 0,
            dewpt: 64.3,
            uv: 6.6,
            weather: {
              icon: "r03d",
              code: 502,
              description: "Heavy rain",
            },
            wind_dir: 172,
            max_dhi: null,
            clouds_hi: 0,
            precip: 0.81,
            low_temp: 63.6,
            max_temp: 68,
            moonset_ts: 1664866105,
            datetime: "2022-10-04",
            temp: 65.5,
            min_temp: 63.7,
            clouds_mid: 62,
            clouds_low: 100,
          },
          {
            moonrise_ts: 1665005137,
            wind_cdir: "SW",
            rh: 88,
            pres: 979.5,
            high_temp: 71.2,
            sunset_ts: 1665012189,
            ozone: 259.4,
            moon_phase: 0.847951,
            wind_gust_spd: 9.4,
            snow_depth: 0,
            clouds: 86,
            ts: 1664946060,
            sunrise_ts: 1664970219,
            app_min_temp: 63.7,
            wind_spd: 5.4,
            pop: 45,
            wind_cdir_full: "southwest",
            moon_phase_lunation: 0.34,
            slp: 1010.8,
            app_max_temp: 71.6,
            valid_date: "2022-10-05",
            vis: 7.6,
            snow: 0,
            dewpt: 63.5,
            uv: 6.5,
            weather: {
              icon: "r01d",
              code: 500,
              description: "Light rain",
            },
            wind_dir: 227,
            max_dhi: null,
            clouds_hi: 0,
            precip: 0.098,
            low_temp: 63.9,
            max_temp: 71.2,
            moonset_ts: 1664956817,
            datetime: "2022-10-05",
            temp: 67.4,
            min_temp: 63.6,
            clouds_mid: 0,
            clouds_low: 86,
          },
          {
            moonrise_ts: 1665093656,
            wind_cdir: "SSW",
            rh: 75,
            pres: 981.3,
            high_temp: 82.3,
            sunset_ts: 1665098507,
            ozone: 259.6,
            moon_phase: 0.923081,
            wind_gust_spd: 12.3,
            snow_depth: 0,
            clouds: 43,
            ts: 1665032460,
            sunrise_ts: 1665056666,
            app_min_temp: 65.8,
            wind_spd: 6.5,
            pop: 60,
            wind_cdir_full: "south-southwest",
            moon_phase_lunation: 0.38,
            slp: 1012,
            app_max_temp: 85.4,
            valid_date: "2022-10-06",
            vis: 15,
            snow: 0,
            dewpt: 64.8,
            uv: 6.5,
            weather: {
              icon: "r01d",
              code: 500,
              description: "Light rain",
            },
            wind_dir: 213,
            max_dhi: null,
            clouds_hi: 0,
            precip: 0.192,
            low_temp: 66.5,
            max_temp: 82.3,
            moonset_ts: 1665047420,
            datetime: "2022-10-06",
            temp: 73.9,
            min_temp: 62.5,
            clouds_mid: 42,
            clouds_low: 4,
          },
          {
            moonrise_ts: 1665181916,
            wind_cdir: "NE",
            rh: 65,
            pres: 983.5,
            high_temp: 82.4,
            sunset_ts: 1665184826,
            ozone: 264.6,
            moon_phase: 0.973592,
            wind_gust_spd: 3.6,
            snow_depth: 0,
            clouds: 0,
            ts: 1665118860,
            sunrise_ts: 1665143114,
            app_min_temp: 66.9,
            wind_spd: 3.8,
            pop: 0,
            wind_cdir_full: "northeast",
            moon_phase_lunation: 0.41,
            slp: 1014.8,
            app_max_temp: 82.1,
            valid_date: "2022-10-07",
            vis: 15,
            snow: 0,
            dewpt: 60,
            uv: 6.4,
            weather: {
              icon: "c01d",
              code: 800,
              description: "Clear Sky",
            },
            wind_dir: 41,
            max_dhi: null,
            clouds_hi: 0,
            precip: 0,
            low_temp: 60.9,
            max_temp: 82.4,
            moonset_ts: 1665137884,
            datetime: "2022-10-07",
            temp: 74.4,
            min_temp: 64.5,
            clouds_mid: 0,
            clouds_low: 0,
          },
        ],
        city_name: "Fayetteville",
        lon: -86.5664,
        timezone: "America/Chicago",
        lat: 35.1527,
        country_code: "US",
        state_code: "TN",
      };
    }
  };
  const data = await getForecast(zipCode, travelDate);
  expect(data.cityName).toBe("Fayetteville");
  expect(data.stateName).toBe("Tennessee");
  expect(data.timezone).toBe("America/Chicago");
  expect(typeof parseInt(data.tempLow)).toBe("number");
  expect(typeof parseInt(data.tempHigh)).toBe("number");
});
